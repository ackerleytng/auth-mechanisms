<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1880" height="4269"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1880" height="4269"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="686.9189621007123" y="24.50280495" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">OpenID Connect/Keycloak SSO Sequence Diagram</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.363373646515626 95.887643371 L 41.363373646515626 4269.532086520998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 235.48403363063017 95.887643371 L 235.48403363063017 4269.532086520998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 939.3673278920886 95.887643371 L 939.3673278920886 4269.532086520998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1299.4765766728178 95.887643371 L 1299.4765766728178 4269.532086520998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1624.95160677412 95.887643371 L 1624.95160677412 4269.532086520998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="12.565541,5.445067766666667"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.167601650000002 51.782594461 L 74.55914564303126 51.782594461 L 74.55914564303126 95.887643371 L 8.167601650000002 95.887643371 L 8.167601650000002 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="25.8912972305" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 190.88458274007155 51.782594461 L 280.0834845211888 51.782594461 L 280.0834845211888 95.887643371 L 190.88458274007155 95.887643371 L 190.88458274007155 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="208.60827832057157" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Browser</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 846.2834562251628 51.782594461 L 1032.4511995590144 51.782594461 L 1032.4511995590144 95.887643371 L 846.2834562251628 95.887643371 L 846.2834562251628 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="864.0071518056628" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Protected App (httpbin)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1252.0181551401695 51.782594461 L 1346.9349982054664 51.782594461 L 1346.9349982054664 95.887643371 L 1252.0181551401695 95.887643371 L 1252.0181551401695 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1269.7418507206694" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Keycloak</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1518.0237333371747 51.782594461 L 1731.8794802110654 51.782594461 L 1731.8794802110654 95.887643371 L 1518.0237333371747 95.887643371 L 1518.0237333371747 51.782594461 Z" stroke-miterlimit="10" stroke-width="2.613632528" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1535.7474289176746" y="79.55244007099999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Protected App (httpbin-two)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 211.867586801 L 243.65163528063016 211.867586801 L 243.65163528063016 1954.833778911 L 227.31643198063017 1954.833778911 L 227.31643198063017 211.867586801" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 257.60615604099996 L 947.5349295420887 257.60615604099996 L 947.5349295420887 414.4241077209999 L 931.1997262420886 414.4241077209999 L 931.1997262420886 257.60615604099996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 460.16267696099993 L 947.5349295420887 460.16267696099993 L 947.5349295420887 603.912466001 L 931.1997262420886 603.912466001 L 931.1997262420886 460.16267696099993" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 731.327051741 L 1307.6441783228179 731.327051741 L 1307.6441783228179 871.8098001210001 L 1291.3089750228178 871.8098001210001 L 1291.3089750228178 731.327051741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 33.195771996515624 933.8835726610001 L 49.53097529651563 933.8835726610001 L 49.53097529651563 995.9573452010002 L 33.195771996515624 995.9573452010002 L 33.195771996515624 933.8835726610001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 1107.0367276410002 L 1307.6441783228179 1107.0367276410002 L 1307.6441783228179 1285.0904436110002 L 1291.3089750228178 1285.0904436110002 L 1291.3089750228178 1107.0367276410002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 1396.1698260510002 L 947.5349295420887 1396.1698260510002 L 947.5349295420887 1739.209095351 L 931.1997262420886 1739.209095351 L 931.1997262420886 1396.1698260510002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 1520.317371131 L 1307.6441783228179 1520.317371131 L 1307.6441783228179 1628.129712911 L 1291.3089750228178 1628.129712911 L 1291.3089750228178 1520.317371131" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 1801.282867891 L 947.5349295420887 1801.282867891 L 947.5349295420887 1909.095209671 L 931.1997262420886 1909.095209671 L 931.1997262420886 1801.282867891" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 2062.646120691 L 243.65163528063016 2062.646120691 L 243.65163528063016 2278.2708042509994 L 227.31643198063017 2278.2708042509994 L 227.31643198063017 2062.646120691" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 2124.719893231 L 947.5349295420887 2124.719893231 L 947.5349295420887 2232.5322350109996 L 931.1997262420886 2232.5322350109996 L 931.1997262420886 2124.719893231" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 2386.083146030999 L 243.65163528063016 2386.083146030999 L 243.65163528063016 2758.525781270999 L 227.31643198063017 2758.525781270999 L 227.31643198063017 2386.083146030999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 2448.156918570999 L 947.5349295420887 2448.156918570999 L 947.5349295420887 2712.787212030999 L 931.1997262420886 2712.787212030999 L 931.1997262420886 2448.156918570999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 2604.974870250999 L 1307.6441783228179 2604.974870250999 L 1307.6441783228179 2650.713439490999 L 1291.3089750228178 2650.713439490999 L 1291.3089750228178 2604.974870250999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 2866.3381230509985 L 243.65163528063016 2866.3381230509985 L 243.65163528063016 4212.358874970998 L 227.31643198063017 4212.358874970998 L 227.31643198063017 2866.3381230509985" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 2912.0766922909984 L 1633.11920842412 2912.0766922909984 L 1633.11920842412 3036.2242373709983 L 1616.7840051241199 3036.2242373709983 L 1616.7840051241199 2912.0766922909984" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 3081.962806610998 L 1633.11920842412 3081.962806610998 L 1633.11920842412 3225.712595650998 L 1616.7840051241199 3225.712595650998 L 1616.7840051241199 3081.962806610998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 3369.462384690998 L 1307.6441783228179 3369.462384690998 L 1307.6441783228179 3542.6155396709983 L 1291.3089750228178 3542.6155396709983 L 1291.3089750228178 3369.462384690998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 3653.694922110998 L 1633.11920842412 3653.694922110998 L 1633.11920842412 3996.7341914109975 L 1616.7840051241199 3996.7341914109975 L 1616.7840051241199 3653.694922110998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 3777.842467190998 L 1307.6441783228179 3777.842467190998 L 1307.6441783228179 3885.6548089709977 L 1291.3089750228178 3885.6548089709977 L 1291.3089750228178 3777.842467190998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 4058.8079639509974 L 1633.11920842412 4058.8079639509974 L 1633.11920842412 4166.620305730998 L 1616.7840051241199 4166.620305730998 L 1616.7840051241199 4058.8079639509974" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 141.89846599933333 L 1871.83239835 141.89846599933333 M 8.16760165 147.34353376599998 L 1871.83239835 147.34353376599998 M 8.16760165 152.78860153266663 L 1871.83239835 152.78860153266663" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 877.2303629019726 128.558049971 L 1002.7696370980273 128.558049971 L 1002.7696370980273 166.129017561 L 877.2303629019726 166.129017561 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="900.0996475219727" y="151.42733459099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">First Access</text></g><g><g><rect fill="white" stroke="none" x="86.76154004318228" y="190.631822511" width="95.15672554078125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="89.21182053818228" y="205.33350548099997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Goto "httpbin"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.363373646515626 211.867586801 L 224.59389809729683 211.867586801" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(227.31643198063017,211.867586801) translate(-227.31643198063017,-211.867586801)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 213.7037625639635 205.06125209266665 L 227.31643198063017 211.867586801 L 213.7037625639635 218.67392150933333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="478.2631581398946" y="236.37039175099997" width="218.3250452429297" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="480.7134386348946" y="251.07207472099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="550.7600084591134" y="251.07207472099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="558.903959875129" y="251.07207472099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 257.60615604099996 L 928.4771923587552 257.60615604099996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(931.1997262420886,257.60615604099996) translate(-931.1997262420886,-257.60615604099996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.5870568254219 250.79982133266662 L 931.1997262420886 257.60615604099996 L 917.5870568254219 264.4124907493333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 947.5349295420887 309.06204643599995 L 955.7025311920887 309.06204643599995 M 955.7025311920887 282.10896099099995 L 1171.6529153868933 282.10896099099995 L 1186.3545983568933 296.8106439609999 L 1186.3545983568933 336.01513188099995 L 955.7025311920887 336.01513188099995 L 955.7025311920887 282.10896099099995 M 1171.6529153868933 282.10896099099995 L 1171.6529153868933 296.8106439609999 L 1186.3545983568933 296.8106439609999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="978.5718158120887" y="304.9782456109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">No access token, so forward</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="978.5718158120887" y="321.3134489109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to authorize endpoint</text></g><g><g><rect fill="white" stroke="none" x="333.407422361086" y="360.51793683099993" width="508.03651680054685" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="333.407422361086" y="376.8531401309999" width="424.4285456091406" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="333.407422361086" y="393.1883434309999" width="308.78874458375" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="335.857702856086" y="375.2196198009999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">307 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="463.78500998499226" y="375.2196198009999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="471.9289614010079" y="375.2196198009999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com/oauth/authorize?state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="335.857702856086" y="391.5548231009999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">This is probably a keycloak-gatekeeper specific implementation -</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="335.857702856086" y="407.8900264009999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to generate the OpenID redirect to the provider</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 414.4241077209999 L 246.3741691639635 414.4241077209999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,414.4241077209999) translate(-243.65163528063016,-414.4241077209999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 407.6177730126666 L 243.65163528063016 414.4241077209999 L 257.26430469729684 421.23044242933327 Z"/></g></g><g><g><rect fill="white" stroke="none" x="362.34779101342974" y="438.9269126709999" width="450.15577949585935" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="364.79807150842976" y="453.6285956409999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="434.8446413326485" y="453.6285956409999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="442.98859274866413" y="453.6285956409999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com/oauth/authorize?state=&lt;uuid-auth&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 460.16267696099993 L 928.4771923587552 460.16267696099993" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(931.1997262420886,460.16267696099993) translate(-931.1997262420886,-460.16267696099993)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.5870568254219 453.3563422526666 L 931.1997262420886 460.16267696099993 L 917.5870568254219 466.96901166933327 Z"/></g></g><g><g><rect fill="white" stroke="none" x="294.93473559350787" y="484.665481911" width="584.9818903357032" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="294.93473559350787" y="501.00068521099996" width="119.38820137085938" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="294.93473559350787" y="517.335888511" width="373.5395990759375" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="294.93473559350787" y="533.671091811" width="151.16249336304688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="294.93473559350787" y="550.006295111" width="198.41601814332031" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="294.93473559350787" y="566.341498411" width="133.24293769898438" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="294.93473559350787" y="582.676701711" width="366.5831781775" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.3850160885079" y="499.36716488099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">307 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="425.31232321741413" y="499.36716488099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="433.45627463342976" y="499.36716488099995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">keycloak.com/auth/realms/applications/protocol/openid-connect/auth</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.3850160885079" y="515.702368181" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?client_id=httpbin</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.3850160885079" y="532.037571481" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;redirect_uri=https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="424.87578452112507" y="532.037571481" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="433.0197359371407" y="532.037571481" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.3850160885079" y="548.372774781" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;response_type=code</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.3850160885079" y="564.707978081" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;scope=openid+email+profile</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.3850160885079" y="581.043181381" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="297.3850160885079" y="597.378384681" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also set OAuth Token Request State (CSRF Protection)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 603.912466001 L 246.3741691639635 603.912466001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,603.912466001) translate(-243.65163528063016,-603.912466001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 597.1061312926666 L 243.65163528063016 603.912466001 L 257.26430469729684 610.7188007093333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="503.92972863621617" y="628.415270951" width="527.1011530310157" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="644.750474251" width="119.38820137085938" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="661.085677551" width="373.5395990759375" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="677.420880851" width="151.16249336304688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="693.756084151" width="198.41601814332031" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="710.091287451" width="133.24293769898438" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="643.116953921" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="576.4265789554349" y="643.116953921" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="584.5705303714506" y="643.116953921" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">keycloak.com/auth/realms/applications/protocol/openid-connect/auth</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="659.452157221" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?client_id=httpbin</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="675.787360521" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;redirect_uri=https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="633.8707775638334" y="675.787360521" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.014728979849" y="675.787360521" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="692.122563821" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;response_type=code</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="708.457767121" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;scope=openid+email+profile</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="724.792970421" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;state=&lt;uuid-auth&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 731.327051741 L 1288.5864411394844 731.327051741" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1291.3089750228178,731.327051741) translate(-1291.3089750228178,-731.327051741)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1277.696305606151 724.5207170326667 L 1291.3089750228178 731.327051741 L 1277.696305606151 738.1333864493333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1307.6441783228179 782.782942136 L 1315.811779972818 782.782942136 M 1315.811779972818 755.829856691 L 1513.0482512037554 755.829856691 L 1527.7499341737555 770.531539661 L 1527.7499341737555 809.736027581 L 1315.811779972818 809.736027581 L 1315.811779972818 755.829856691 M 1513.0482512037554 755.829856691 L 1513.0482512037554 770.531539661 L 1527.7499341737555 770.531539661" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1338.6810645928178" y="778.699141311" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User is not authenticated,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1338.6810645928178" y="795.0343446109999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> so present login form</text></g><g><g><rect fill="white" stroke="none" x="527.8144027084818" y="834.2388325310001" width="479.33180488648435" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="527.8144027084818" y="850.5740358310001" width="434.5547968298437" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="530.2646832034818" y="848.940515501" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return login form with parameters from httpbin's request stored in a JWT.</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="530.2646832034818" y="865.275718801" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Keycloak's CSRF protection is handled using server-side sessions</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 871.8098001210001 L 246.3741691639635 871.8098001210001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,871.8098001210001) translate(-243.65163528063016,-871.8098001210001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 865.0034654126667 L 243.65163528063016 871.8098001210001 L 257.26430469729684 878.6161348293334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="80.17519011134634" y="896.3126050710001" width="116.49702705445313" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="80.17519011134634" y="912.6478083710001" width="69.25065864625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.62547060634634" y="911.0142880410001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Display Keycloak</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.62547060634634" y="927.3494913410001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">login form</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 933.8835726610001 L 52.25350917984896 933.8835726610001" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(49.53097529651563,933.8835726610001) translate(-49.53097529651563,-933.8835726610001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 63.1436447131823 927.0772379526668 L 49.53097529651563 933.8835726610001 L 63.1436447131823 940.6899073693335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="80.1787682973815" y="958.3863776110002" width="52.14692939820313" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="80.1787682973815" y="974.7215809110002" width="116.48987068238281" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.6290487923815" y="973.0880605810001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Fill and</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="82.6290487923815" y="989.4232638810001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">submit login form</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 49.53097529651563 995.9573452010002 L 224.59389809729683 995.9573452010002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(227.31643198063017,995.9573452010002) translate(-227.31643198063017,-995.9573452010002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 213.7037625639635 989.1510104926668 L 227.31643198063017 995.9573452010002 L 213.7037625639635 1002.7636799093335 Z"/></g></g><g><g><rect fill="white" stroke="none" x="510.4527541489115" y="1020.4601501510002" width="514.055102005625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="510.4527541489115" y="1036.7953534510002" width="119.38820137085938" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="510.4527541489115" y="1053.1305567510003" width="252.11743415894531" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="510.4527541489115" y="1069.4657600510004" width="279.4400507360937" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="510.4527541489115" y="1085.8009633510005" width="499.7278925329687" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="512.9030346439115" y="1035.1618331210002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">POST https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="592.7252087161771" y="1035.1618331210002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="600.8691601321927" y="1035.1618331210002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">keycloak.com/auth/realms/applications/login-actions/authenticate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="512.9030346439115" y="1051.4970364210003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?client_id=httpbin</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="512.9030346439115" y="1067.8322397210004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;&lt;more Keycloak-specific parameters</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="512.9030346439115" y="1084.1674430210005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Username and password POSTed in Body</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="512.9030346439115" y="1100.5026463210006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Keycloak session ID, httpbin's request JWT returned to Keycloak in Headers</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 1107.0367276410002 L 1288.5864411394844 1107.0367276410002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1291.3089750228178,1107.0367276410002) translate(-1291.3089750228178,-1107.0367276410002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1277.696305606151 1100.230392932667 L 1291.3089750228178 1107.0367276410002 L 1277.696305606151 1113.8430623493334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1326.9741688944846" y="1131.5395325910001" width="121.39914192261719" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1329.4244493894846" y="1146.2412155610002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authenticate User</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1307.6441783228179 1152.7752968810003 L 1372.9849915228178 1152.7752968810003 L 1372.9849915228178 1174.0110611710002 L 1310.3667122061513 1174.0110611710002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1307.6441783228179,1174.0110611710002) translate(-1307.6441783228179,-1174.0110611710002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1321.2568477394846 1167.204726462667 L 1307.6441783228179 1174.0110611710002 L 1321.2568477394846 1180.8173958793334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="443.0362502426615" y="1198.513866121" width="373.97613777222654" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.0362502426615" y="1214.8490694210002" width="131.61844123902344" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.0362502426615" y="1231.1842727210003" width="648.888109818125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.0362502426615" y="1247.5194760210004" width="261.978930130625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.0362502426615" y="1263.8546793210005" width="437.5175348669531" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="1213.2155490910002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="573.4138378665677" y="1213.2155490910002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="581.5577892825834" y="1213.2155490910002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="1229.5507523910003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="1245.8859556910004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;session_state=&lt;Keycloak parameter to link this redirect with token set in cookie on Keycloak site&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="1262.2211589910005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;code=&lt;OAuth 2.0 authorization code&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="1278.5563622910006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also set cookie on Keycloak site to indicate that user has logged in</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 1285.0904436110002 L 246.3741691639635 1285.0904436110002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,1285.0904436110002) translate(-243.65163528063016,-1285.0904436110002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 1278.284108902667 L 243.65163528063016 1285.0904436110002 L 257.26430469729684 1291.8967783193334 Z"/></g></g><g><g><rect fill="white" stroke="none" x="262.98162585229693" y="1309.593248561" width="316.09540046753904" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="262.98162585229693" y="1325.9284518610002" width="131.61844123902344" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="262.98162585229693" y="1342.2636551610003" width="648.888109818125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="262.98162585229693" y="1358.5988584610004" width="261.978930130625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="262.98162585229693" y="1374.9340617610005" width="455.3865839392187" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.43190634729694" y="1324.2949315310002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="335.4784761715157" y="1324.2949315310002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="343.6224275875313" y="1324.2949315310002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.43190634729694" y="1340.6301348310003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.43190634729694" y="1356.9653381310004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;session_state=&lt;Keycloak parameter to link this redirect with token set in cookie on Keycloak site&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.43190634729694" y="1373.3005414310005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;code=&lt;OAuth 2.0 authorization code&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.43190634729694" y="1389.6357447310006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also send cookie with OAuth Token Request State (CSRF Protection)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 1396.1698260510002 L 928.4771923587552 1396.1698260510002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(931.1997262420886,1396.1698260510002) translate(-931.1997262420886,-1396.1698260510002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.5870568254219 1389.363491342667 L 931.1997262420886 1396.1698260510002 L 917.5870568254219 1402.9761607593334 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 947.5349295420887 1439.4581147960002 L 955.7025311920887 1439.4581147960002 M 955.7025311920887 1420.6726310010001 L 1133.0936655089636 1420.6726310010001 L 1147.7953484789637 1435.3743139710002 L 1147.7953484789637 1458.2435985910001 L 955.7025311920887 1458.2435985910001 L 955.7025311920887 1420.6726310010001 M 1133.0936655089636 1420.6726310010001 L 1133.0936655089636 1435.3743139710002 L 1147.7953484789637 1435.3743139710002" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="978.5718158120887" y="1443.5419156210003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validates CSRF Token</text></g><g><g><rect fill="white" stroke="none" x="998.8378598367697" y="1482.746403541" width="191.46002449097656" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="998.8378598367697" y="1499.0816068410002" width="241.1681848913672" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1001.2881403317697" y="1497.4480865110002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authenticates with Keycloak,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1001.2881403317697" y="1513.7832898110003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sends Authorization Code over https</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 947.5349295420887 1520.317371131 L 1288.5864411394844 1520.317371131" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1291.3089750228178,1520.317371131) translate(-1291.3089750228178,-1520.317371131)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1277.696305606151 1513.5110364226668 L 1291.3089750228178 1520.317371131 L 1277.696305606151 1527.1237058393333 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1307.6441783228179 1563.6056598760001 L 1315.811779972818 1563.6056598760001 M 1315.811779972818 1544.820176081 L 1538.85383897231 1544.820176081 L 1553.5555219423102 1559.521859051 L 1553.5555219423102 1582.391143671 L 1315.811779972818 1582.391143671 L 1315.811779972818 1544.820176081 M 1538.85383897231 1544.820176081 L 1538.85383897231 1559.521859051 L 1553.5555219423102 1559.521859051" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1338.6810645928178" y="1567.6894607010001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validates Authorization Code </text></g><g><g><rect fill="white" stroke="none" x="984.1820294534689" y="1606.8939486210002" width="270.4798456579687" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="986.6323099484689" y="1621.5956315910003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return Access Token and Refresh Token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 1628.129712911 L 950.257463425422 1628.129712911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(947.5349295420887,1628.129712911) translate(-947.5349295420887,-1628.129712911)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 961.1475989587553 1621.3233782026668 L 947.5349295420887 1628.129712911 L 961.1475989587553 1634.9360476193333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="353.22726183862505" y="1652.632517861" width="276.20578254761716" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="353.22726183862505" y="1668.967721161" width="307.9080683142187" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="353.22726183862505" y="1685.3029244610002" width="237.06715644898438" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="353.22726183862505" y="1701.6381277610003" width="298.1467768103125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="353.22726183862505" y="1717.9733310610004" width="468.3968378454687" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.67754233362507" y="1667.334200831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">307 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="483.6048494625313" y="1667.334200831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="491.74880087854694" y="1667.334200831" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.67754233362507" y="1683.6694041310002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also set Access Token in a Cookie (kc-access)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.67754233362507" y="1700.0046074310003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Access Token lasts 5 min by default</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.67754233362507" y="1716.3398107310004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also set Refresh Token in a Cookie (kc-state)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.67754233362507" y="1732.6750140310005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Refresh Token is encrypted with a symmetric key (in gatekeeper config)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 1739.209095351 L 246.3741691639635 1739.209095351" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,1739.209095351) translate(-243.65163528063016,-1739.209095351)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 1732.4027606426669 L 243.65163528063016 1739.209095351 L 257.26430469729684 1746.0154300593333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="349.1590855690938" y="1763.711900301" width="218.3250452429297" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="349.1590855690938" y="1780.0471036010001" width="476.5331903845312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="351.6093660640938" y="1778.413583271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="421.65593588831257" y="1778.413583271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="429.7998873043282" y="1778.413583271" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="351.6093660640938" y="1794.7487865710002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">This time with Access Token and Refresh Token in Header (from Cookie)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 1801.282867891 L 928.4771923587552 1801.282867891" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(931.1997262420886,1801.282867891) translate(-931.1997262420886,-1801.282867891)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.5870568254219 1794.4765331826668 L 931.1997262420886 1801.282867891 L 917.5870568254219 1808.0892025993332 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 947.5349295420887 1844.571156636 L 955.7025311920887 1844.571156636 M 955.7025311920887 1825.785672841 L 1133.1079782531042 1825.785672841 L 1147.8096612231043 1840.487355811 L 1147.8096612231043 1863.356640431 L 955.7025311920887 1863.356640431 L 955.7025311920887 1825.785672841 M 1133.1079782531042 1825.785672841 L 1133.1079782531042 1840.487355811 L 1147.8096612231043 1840.487355811" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="978.5718158120887" y="1848.654957461" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate Access Token</text></g><g><g><rect fill="white" stroke="none" x="499.84319811792193" y="1887.8594453810001" width="175.164965286875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="502.29347861292194" y="1902.5611283510002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return protected resource</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 1909.095209671 L 246.3741691639635 1909.095209671" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,1909.095209671) translate(-243.65163528063016,-1909.095209671)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 1902.2888749626668 L 243.65163528063016 1909.095209671 L 257.26430469729684 1915.9015443793332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.62116681320181" y="1933.5980146210002" width="111.43747200074219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.07144730820181" y="1948.2996975910003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Display "httpbin"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 1954.833778911 L 44.08590752984896 1954.833778911" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(41.363373646515626,1954.833778911) translate(-41.363373646515626,-1954.833778911)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 54.976043063182296 1948.0274442026669 L 41.363373646515626 1954.833778911 L 54.976043063182296 1961.6401136193333 Z"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 1992.6769998893335 L 1871.83239835 1992.6769998893335 M 8.16760165 1998.1220676560001 L 1871.83239835 1998.1220676560001 M 8.16760165 2003.5671354226668 L 1871.83239835 2003.5671354226668" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 797.7805338004101 1979.336583861 L 1082.2194661995898 1979.336583861 L 1082.2194661995898 2016.907551451 L 797.7805338004101 2016.907551451 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="820.6498184204102" y="2002.2058684810002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Second Access To Same Application</text></g><g><g><rect fill="white" stroke="none" x="86.76154004318228" y="2041.410356401" width="95.15672554078125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="89.21182053818228" y="2056.112039371" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Goto "httpbin"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.363373646515626 2062.646120691 L 224.59389809729683 2062.646120691" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(227.31643198063017,2062.646120691) translate(-227.31643198063017,-2062.646120691)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 213.7037625639635 2055.8397859826664 L 227.31643198063017 2062.646120691 L 213.7037625639635 2069.4524553993333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="349.1590855690938" y="2087.148925641" width="218.3250452429297" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="349.1590855690938" y="2103.484128941" width="476.5331903845312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="351.6093660640938" y="2101.850608611" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="421.65593588831257" y="2101.850608611" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="429.7998873043282" y="2101.850608611" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="351.6093660640938" y="2118.185811911" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">This time with Access Token and Refresh Token in Header (from Cookie)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 2124.719893231 L 928.4771923587552 2124.719893231" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(931.1997262420886,2124.719893231) translate(-931.1997262420886,-2124.719893231)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.5870568254219 2117.9135585226663 L 931.1997262420886 2124.719893231 L 917.5870568254219 2131.5262279393332 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 947.5349295420887 2168.008181976 L 955.7025311920887 2168.008181976 M 955.7025311920887 2149.222698181 L 1133.1079782531042 2149.222698181 L 1147.8096612231043 2163.924381151 L 1147.8096612231043 2186.7936657709997 L 955.7025311920887 2186.7936657709997 L 955.7025311920887 2149.222698181 M 1133.1079782531042 2149.222698181 L 1133.1079782531042 2163.924381151 L 1147.8096612231043 2163.924381151" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="978.5718158120887" y="2172.091982801" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate Access Token</text></g><g><g><rect fill="white" stroke="none" x="499.84319811792193" y="2211.2964707209994" width="175.164965286875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="502.29347861292194" y="2225.9981536909995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return protected resource</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 2232.5322350109996 L 246.3741691639635 2232.5322350109996" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,2232.5322350109996) translate(-243.65163528063016,-2232.5322350109996)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 2225.725900302666 L 243.65163528063016 2232.5322350109996 L 257.26430469729684 2239.338569719333 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.62116681320181" y="2257.0350399609993" width="111.43747200074219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.07144730820181" y="2271.7367229309993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Display "httpbin"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 2278.2708042509994 L 44.08590752984896 2278.2708042509994" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(41.363373646515626,2278.2708042509994) translate(-41.363373646515626,-2278.2708042509994)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 54.976043063182296 2271.464469542666 L 41.363373646515626 2278.2708042509994 L 54.976043063182296 2285.077138959333 Z"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 2316.1140252293326 L 1871.83239835 2316.1140252293326 M 8.16760165 2321.5590929959994 L 1871.83239835 2321.5590929959994 M 8.16760165 2327.0041607626663 L 1871.83239835 2327.0041607626663" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 733.4414148428906 2302.7736092009995 L 1146.5585851571093 2302.7736092009995 L 1146.5585851571093 2340.3445767909993 L 733.4414148428906 2340.3445767909993 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="756.3106994628906" y="2325.6428938209997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Access To Same Application After Access Token Expires</text></g><g><g><rect fill="white" stroke="none" x="86.76154004318228" y="2364.847381740999" width="95.15672554078125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="89.21182053818228" y="2379.549064710999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Goto "httpbin"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.363373646515626 2386.083146030999 L 224.59389809729683 2386.083146030999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(227.31643198063017,2386.083146030999) translate(-227.31643198063017,-2386.083146030999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 213.7037625639635 2379.2768113226657 L 227.31643198063017 2386.083146030999 L 213.7037625639635 2392.8894807393326 Z"/></g></g><g><g><rect fill="white" stroke="none" x="349.1590855690938" y="2410.5859509809993" width="218.3250452429297" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="349.1590855690938" y="2426.9211542809994" width="476.5331903845312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="351.6093660640938" y="2425.2876339509994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="421.65593588831257" y="2425.2876339509994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="429.7998873043282" y="2425.2876339509994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin.example.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="351.6093660640938" y="2441.6228372509995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">This time with Access Token and Refresh Token in Header (from Cookie)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 2448.156918570999 L 928.4771923587552 2448.156918570999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(931.1997262420886,2448.156918570999) translate(-931.1997262420886,-2448.156918570999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 917.5870568254219 2441.3505838626656 L 931.1997262420886 2448.156918570999 L 917.5870568254219 2454.9632532793325 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 947.5349295420887 2499.612808965999 L 955.7025311920887 2499.612808965999 M 955.7025311920887 2472.6597235209993 L 1137.179953961112 2472.6597235209993 L 1151.881636931112 2487.3614064909993 L 1151.881636931112 2526.565894410999 L 955.7025311920887 2526.565894410999 L 955.7025311920887 2472.6597235209993 M 1137.179953961112 2472.6597235209993 L 1137.179953961112 2487.3614064909993 L 1151.881636931112 2487.3614064909993" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="978.5718158120887" y="2495.5290081409994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate Access Token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="978.5718158120887" y="2511.8642114409995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Access Token expired</text></g><g><g><rect fill="white" stroke="none" x="994.3797604715353" y="2551.0686993609993" width="250.08438362183594" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="994.3797604715353" y="2567.4039026609994" width="191.46002449097656" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="994.3797604715353" y="2583.7391059609995" width="213.45828498902344" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="996.8300409665353" y="2565.7703823309994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Decrypts Refresh Token from Header,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="996.8300409665353" y="2582.1055856309995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authenticates with Keycloak,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="996.8300409665353" y="2598.4407889309996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Sends Refresh Token over https</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 947.5349295420887 2604.974870250999 L 1288.5864411394844 2604.974870250999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1291.3089750228178,2604.974870250999) translate(-1291.3089750228178,-2604.974870250999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1277.696305606151 2598.1685355426657 L 1291.3089750228178 2604.974870250999 L 1277.696305606151 2611.7812049593326 Z"/></g></g><g><g><rect fill="white" stroke="none" x="967.4862286722189" y="2629.477675200999" width="303.8714472204687" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="969.9365091672189" y="2644.179358170999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return New Access Token and Refresh Token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 2650.713439490999 L 950.257463425422 2650.713439490999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(947.5349295420887,2650.713439490999) translate(-947.5349295420887,-2650.713439490999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 961.1475989587553 2643.9071047826656 L 947.5349295420887 2650.713439490999 L 961.1475989587553 2657.5197741993325 Z"/></g></g><g><g><rect fill="white" stroke="none" x="361.7650120827657" y="2675.216244440999" width="179.23694099488281" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="361.7650120827657" y="2691.5514477409993" width="451.3213373571875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="364.2152925777657" y="2689.9179274109993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return protected resource,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="364.2152925777657" y="2706.2531307109994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">with new Access Token and Refresh Token (encrypted) set as cookie</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 931.1997262420886 2712.787212030999 L 246.3741691639635 2712.787212030999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,2712.787212030999) translate(-243.65163528063016,-2712.787212030999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 2705.9808773226655 L 243.65163528063016 2712.787212030999 L 257.26430469729684 2719.5935467393324 Z"/></g></g><g><g><rect fill="white" stroke="none" x="78.62116681320181" y="2737.2900169809986" width="111.43747200074219" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="81.07144730820181" y="2751.9916999509987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Display "httpbin"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 2758.525781270999 L 44.08590752984896 2758.525781270999" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(41.363373646515626,2758.525781270999) translate(-41.363373646515626,-2758.525781270999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 54.976043063182296 2751.7194465626653 L 41.363373646515626 2758.525781270999 L 54.976043063182296 2765.3321159793322 Z"/></g></g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 8.16760165 2796.369002249332 L 1871.83239835 2796.369002249332 M 8.16760165 2801.814070015999 L 1871.83239835 2801.814070015999 M 8.16760165 2807.2591377826657 L 1871.83239835 2807.2591377826657" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 804.3069315054883 2783.028586220999 L 1075.6930684945116 2783.028586220999 L 1075.6930684945116 2820.5995538109987 L 804.3069315054883 2820.5995538109987 Z" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="827.1762161254883" y="2805.897870840999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">First Access to Second Application</text></g><g><g><rect fill="white" stroke="none" x="72.91753827316275" y="2845.1023587609984" width="122.84472908082031" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="75.36781876816275" y="2859.8040417309985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Goto "httpbin-two"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 41.363373646515626 2866.3381230509985 L 224.59389809729683 2866.3381230509985" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(227.31643198063017,2866.3381230509985) translate(-227.31643198063017,-2866.3381230509985)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 213.7037625639635 2859.531788342665 L 227.31643198063017 2866.3381230509985 L 213.7037625639635 2873.144457759332 Z"/></g></g><g><g><rect fill="white" stroke="none" x="807.2112958108905" y="2890.8409280009982" width="246.01304878296875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="809.6615763058905" y="2905.5426109709983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="879.7081461301093" y="2905.5426109709983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="887.8520975461249" y="2905.5426109709983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 2912.0766922909984 L 1614.0614712407864 2912.0766922909984" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1616.7840051241199,2912.0766922909984) translate(-1616.7840051241199,-2912.0766922909984)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1603.1713357074532 2905.270357582665 L 1616.7840051241199 2912.0766922909984 L 1603.1713357074532 2918.883026999332 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1633.11920842412 2963.5325826859985 L 1641.28681007412 2963.5325826859985 M 1641.28681007412 2936.5794972409985 L 1857.2371942689247 2936.5794972409985 L 1871.9388772389248 2951.2811802109986 L 1871.9388772389248 2990.4856681309984 L 1641.28681007412 2990.4856681309984 L 1641.28681007412 2936.5794972409985 M 1857.2371942689247 2936.5794972409985 L 1857.2371942689247 2951.2811802109986 L 1871.9388772389248 2951.2811802109986" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1664.15609469412" y="2959.4487818609987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">No access token, so forward</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1664.15609469412" y="2975.783985160999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">to authorize endpoint</text></g><g><g><rect fill="white" stroke="none" x="662.3555371438983" y="3014.988473080998" width="535.7245661169532" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="664.8058176388984" y="3029.690156050998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">307 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="792.7331247678046" y="3029.690156050998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="800.8770761838202" y="3029.690156050998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com/oauth/authorize?state=&lt;uuid-auth&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 3036.2242373709983 L 246.3741691639635 3036.2242373709983" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,3036.2242373709983) translate(-243.65163528063016,-3036.2242373709983)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 3029.417902662665 L 243.65163528063016 3036.2242373709983 L 257.26430469729684 3043.0305720793317 Z"/></g></g><g><g><rect fill="white" stroke="none" x="691.2959057962421" y="3060.727042320998" width="477.8438288122656" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="693.7461862912421" y="3075.428725290998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="763.7927561154609" y="3075.428725290998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="771.9367075314765" y="3075.428725290998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com/oauth/authorize?state=&lt;uuid-auth&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 3081.962806610998 L 1614.0614712407864 3081.962806610998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1616.7840051241199,3081.962806610998) translate(-1616.7840051241199,-3081.962806610998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1603.1713357074532 3075.1564719026646 L 1616.7840051241199 3081.962806610998 L 1603.1713357074532 3088.7691413193315 Z"/></g></g><g><g><rect fill="white" stroke="none" x="637.7268750345233" y="3106.4656115609982" width="584.9818903357032" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="637.7268750345233" y="3122.8008148609983" width="147.07620491089844" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="637.7268750345233" y="3139.1360181609984" width="401.22760261597654" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="637.7268750345233" y="3155.4712214609985" width="151.16249336304688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="637.7268750345233" y="3171.8064247609987" width="198.41601814332031" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="637.7268750345233" y="3188.1416280609988" width="133.24293769898438" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="637.7268750345233" y="3204.476831360999" width="366.5831781775" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="640.1771555295234" y="3121.1672945309983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">307 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="768.1044626584296" y="3121.1672945309983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="776.2484140744452" y="3121.1672945309983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">keycloak.com/auth/realms/applications/protocol/openid-connect/auth</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="640.1771555295234" y="3137.5024978309984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?client_id=httpbin-two</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="640.1771555295234" y="3153.8377011309985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;redirect_uri=https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="767.6679239621405" y="3153.8377011309985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="775.8118753781562" y="3153.8377011309985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="640.1771555295234" y="3170.1729044309986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;response_type=code</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="640.1771555295234" y="3186.5081077309987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;scope=openid+email+profile</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="640.1771555295234" y="3202.843311030999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="640.1771555295234" y="3219.178514330999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also set OAuth Token Request State (CSRF Protection)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 3225.712595650998 L 246.3741691639635 3225.712595650998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,3225.712595650998) translate(-243.65163528063016,-3225.712595650998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 3218.9062609426646 L 243.65163528063016 3225.712595650998 L 257.26430469729684 3232.5189303593315 Z"/></g></g><g><g><rect fill="white" stroke="none" x="503.92972863621617" y="3250.2154006009982" width="527.1011530310157" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="3266.5506039009983" width="147.07620491089844" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="3282.8858072009984" width="401.22760261597654" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="3299.2210105009985" width="151.16249336304688" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="3315.5562138009986" width="198.41601814332031" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="3331.8914171009988" width="133.24293769898438" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="503.92972863621617" y="3348.226620400999" width="487.9341913610937" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="3264.9170835709983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="576.4265789554349" y="3264.9170835709983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="584.5705303714506" y="3264.9170835709983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">keycloak.com/auth/realms/applications/protocol/openid-connect/auth</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="3281.2522868709984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?client_id=httpbin-two</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="3297.5874901709985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;redirect_uri=https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="633.8707775638334" y="3297.5874901709985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="642.014728979849" y="3297.5874901709985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="3313.9226934709986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;response_type=code</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="3330.2578967709987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;scope=openid+email+profile</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="3346.593100070999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="506.3800091312162" y="3362.928303370999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">This time with Keycloak Session ID and Identity in Headers (from Cookies)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 3369.462384690998 L 1288.5864411394844 3369.462384690998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1291.3089750228178,3369.462384690998) translate(-1291.3089750228178,-3369.462384690998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1277.696305606151 3362.6560499826646 L 1291.3089750228178 3369.462384690998 L 1277.696305606151 3376.2687193993315 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1307.6441783228179 3420.918275085998 L 1315.811779972818 3420.918275085998 M 1315.811779972818 3393.9651896409982 L 1539.1046019117632 3393.9651896409982 L 1553.8062848817633 3408.6668726109983 L 1553.8062848817633 3447.871360530998 L 1315.811779972818 3447.871360530998 L 1315.811779972818 3393.9651896409982 M 1539.1046019117632 3393.9651896409982 L 1539.1046019117632 3408.6668726109983 L 1553.8062848817633 3408.6668726109983" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1338.6810645928178" y="3416.8344742609984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User is authenticated</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1338.6810645928178" y="3433.1696775609985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(through Session information)</text></g><g><g><rect fill="white" stroke="none" x="443.0362502426615" y="3472.3741654809983" width="401.6641413122656" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.0362502426615" y="3488.7093687809984" width="131.61844123902344" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.0362502426615" y="3505.0445720809985" width="648.888109818125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="443.0362502426615" y="3521.3797753809986" width="261.978930130625" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="3487.0758484509984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">302 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="573.4138378665677" y="3487.0758484509984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="581.5577892825834" y="3487.0758484509984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="3503.4110517509985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="3519.7462550509986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;session_state=&lt;Keycloak parameter to link this redirect with token set in cookie on Keycloak site&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="445.4865307376615" y="3536.0814583509987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;code=&lt;OAuth 2.0 authorization code&gt;</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 3542.6155396709983 L 246.3741691639635 3542.6155396709983" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,3542.6155396709983) translate(-243.65163528063016,-3542.6155396709983)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 3535.809204962665 L 243.65163528063016 3542.6155396709983 L 257.26430469729684 3549.4218743793317 Z"/></g></g><g><g><rect fill="white" stroke="none" x="605.7737652933124" y="3567.118344620998" width="343.7834040075781" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="605.7737652933124" y="3583.453547920998" width="131.61844123902344" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="605.7737652933124" y="3599.788751220998" width="648.888109818125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="605.7737652933124" y="3616.1239545209983" width="261.978930130625" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="605.7737652933124" y="3632.4591578209984" width="455.3865839392187" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="608.2240457883124" y="3581.820027590998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="678.2706156125312" y="3581.820027590998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="686.4145670285468" y="3581.820027590998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com/oauth/callback</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="608.2240457883124" y="3598.155230890998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">?state=&lt;uuid-auth&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="608.2240457883124" y="3614.4904341909983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;session_state=&lt;Keycloak parameter to link this redirect with token set in cookie on Keycloak site&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="608.2240457883124" y="3630.8256374909984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">&amp;code=&lt;OAuth 2.0 authorization code&gt;</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="608.2240457883124" y="3647.1608407909985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also send cookie with OAuth Token Request State (CSRF Protection)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 3653.694922110998 L 1614.0614712407864 3653.694922110998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1616.7840051241199,3653.694922110998) translate(-1616.7840051241199,-3653.694922110998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1603.1713357074532 3646.8885874026646 L 1616.7840051241199 3653.694922110998 L 1603.1713357074532 3660.5012568193315 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1633.11920842412 3696.983210855998 L 1641.28681007412 3696.983210855998 M 1641.28681007412 3678.197727060998 L 1818.677944390995 3678.197727060998 L 1833.379627360995 3692.8994100309983 L 1833.379627360995 3715.768694650998 L 1641.28681007412 3715.768694650998 L 1641.28681007412 3678.197727060998 M 1818.677944390995 3678.197727060998 L 1818.677944390995 3692.8994100309983 L 1833.379627360995 3692.8994100309983" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1664.15609469412" y="3701.0670116809983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validates CSRF Token</text></g><g><g><rect fill="white" stroke="none" x="1341.6299992777851" y="3740.271499600998" width="191.46002449097656" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="1341.6299992777851" y="3756.6067029009982" width="241.1681848913672" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1344.0802797727852" y="3754.9731825709982" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authenticates with Keycloak,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1344.0802797727852" y="3771.3083858709983" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">sends Authorization Code over https</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 3777.842467190998 L 1310.3667122061513 3777.842467190998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1307.6441783228179,3777.842467190998) translate(-1307.6441783228179,-3777.842467190998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1321.2568477394846 3771.0361324826645 L 1307.6441783228179 3777.842467190998 L 1321.2568477394846 3784.6488018993314 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1291.3089750228178 3821.130755935998 L 1283.1413733728177 3821.130755935998 M 1045.3976314033257 3802.345272140998 L 1268.4396904028179 3802.345272140998 L 1283.141373372818 3817.046955110998 L 1283.141373372818 3839.916239730998 L 1045.3976314033257 3839.916239730998 L 1045.3976314033257 3802.345272140998 M 1268.4396904028179 3802.345272140998 L 1268.4396904028179 3817.046955110998 L 1283.141373372818 3817.046955110998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1068.2669160233256" y="3825.214556760998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validates Authorization Code </text></g><g><g><rect fill="white" stroke="none" x="1326.9741688944844" y="3864.4190446809976" width="270.4798456579687" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1329.4244493894844" y="3879.1207276509977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return Access Token and Refresh Token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1307.6441783228179 3885.6548089709977 L 1614.0614712407864 3885.6548089709977" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(1616.7840051241199,3885.6548089709977) translate(-1616.7840051241199,-3885.6548089709977)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1603.1713357074532 3878.8484742626642 L 1616.7840051241199 3885.6548089709977 L 1603.1713357074532 3892.461143679331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="696.0194012796405" y="3910.1576139209974" width="303.8937860876562" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="696.0194012796405" y="3926.4928172209975" width="307.9080683142187" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="696.0194012796405" y="3942.8280205209976" width="237.06715644898438" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="696.0194012796405" y="3959.1632238209977" width="298.1467768103125" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="696.0194012796405" y="3975.498427120998" width="468.3968378454687" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="698.4696817746405" y="3924.8592968909975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">307 Location: https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="826.3969889035468" y="3924.8592968909975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="834.5409403195624" y="3924.8592968909975" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="698.4696817746405" y="3941.1945001909976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also set Access Token in a Cookie (kc-access)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="698.4696817746405" y="3957.5297034909977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Access Token lasts 5 min by default</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="698.4696817746405" y="3973.864906790998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Also set Refresh Token in a Cookie (kc-state)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="698.4696817746405" y="3990.200110090998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Refresh Token is encrypted with a symmetric key (in gatekeeper config)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 3996.7341914109975 L 246.3741691639635 3996.7341914109975" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,3996.7341914109975) translate(-243.65163528063016,-3996.7341914109975)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 3989.927856702664 L 243.65163528063016 3996.7341914109975 L 257.26430469729684 4003.540526119331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="691.9512250101093" y="4021.2369963609976" width="246.01304878296875" height="21.23576429"/></g><g><rect fill="white" stroke="none" x="691.9512250101093" y="4037.5721996609977" width="476.5331903845312" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="694.4015055051093" y="4035.9386793309977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">GET https:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="764.448075329328" y="4035.9386793309977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">//</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="772.5920267453437" y="4035.9386793309977" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">httpbin-two.example.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="694.4015055051093" y="4052.273882630998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">This time with Access Token and Refresh Token in Header (from Cookie)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 243.65163528063016 4058.8079639509974 L 1614.0614712407864 4058.8079639509974" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(1616.7840051241199,4058.8079639509974) translate(-1616.7840051241199,-4058.8079639509974)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1603.1713357074532 4052.001629242664 L 1616.7840051241199 4058.8079639509974 L 1603.1713357074532 4065.614298659331 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1633.11920842412 4102.0962526959975 L 1641.28681007412 4102.0962526959975 M 1641.28681007412 4083.3107689009976 L 1818.6922571351356 4083.3107689009976 L 1833.3939401051357 4098.012451870997 L 1833.3939401051357 4120.881736490997 L 1641.28681007412 4120.881736490997 L 1641.28681007412 4083.3107689009976 M 1818.6922571351356 4083.3107689009976 L 1818.6922571351356 4098.012451870997 L 1833.3939401051357 4098.012451870997" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1664.15609469412" y="4106.180053520998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Validate Access Token</text></g><g><g><rect fill="white" stroke="none" x="842.6353375589374" y="4145.384541440998" width="175.164965286875" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="845.0856180539374" y="4160.0862244109985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Return protected resource</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1616.7840051241199 4166.620305730998 L 246.3741691639635 4166.620305730998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray="6.53408132"/><g transform="translate(243.65163528063016,4166.620305730998) translate(-243.65163528063016,-4166.620305730998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 257.26430469729684 4159.813971022664 L 243.65163528063016 4166.620305730998 L 257.26430469729684 4173.426640439331 Z"/></g></g><g><g><rect fill="white" stroke="none" x="64.77716504318228" y="4191.123110680998" width="139.12547554078125" height="21.23576429"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="67.22744553818228" y="4205.824793650999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Display "httpbin-two"</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 227.31643198063017 4212.358874970998 L 44.08590752984896 4212.358874970998" stroke-miterlimit="10" stroke-width="1.3612669416666667" stroke-dasharray=""/><g transform="translate(41.363373646515626,4212.358874970998) translate(-41.363373646515626,-4212.358874970998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 54.976043063182296 4205.5525402626645 L 41.363373646515626 4212.358874970998 L 54.976043063182296 4219.165209679331 Z"/></g></g></g><g/><g/><g/><g/><g/></g></svg>